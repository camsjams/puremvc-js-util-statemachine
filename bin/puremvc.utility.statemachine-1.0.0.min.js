puremvc.define({name:"utilities.statemachine.State",parent:puremvc.Notifier,constructor:function(e,t,n,r){this.name=e;if(t)this.entering=t;if(n)this.exiting=n;if(r)this.changed=r}},{name:null,entering:null,exiting:null,changed:null,transitions:{},defineTrans:function(e,t){if(this.getTarget(e)){return}this.transitions[e]=t},removeTrans:function(e){this.transitions[e]=null},getTarget:function(e){return this.transitions[e]}});puremvc.define({name:"utilities.statemachine.StateMachine",parent:puremvc.Mediator},{states:{},initial:null,canceled:false,onRegister:function(){if(this.initial){this.transitionTo(this.initial,null)}},listNotificationInterests:function(){return[utilities.statemachine.StateMachine.ACTION,utilities.statemachine.StateMachine.CANCEL]},handleNotification:function(e){switch(e.getName()){case utilities.statemachine.StateMachine.ACTION:var t=e.getType(),n=this.getCurrentState()?this.getCurrentState().getTarget(t):false,r=n?this.states[n]:false;if(r){this.transitionTo(r,e.getBody())}break;case utilities.statemachine.StateMachine.CANCEL:this.canceled=true;break}},registerState:function(e,t){if(e===null||this.states[e.name]){return}this.states[e.name]=e;if(t){this.initial=e;this.setCurrentState(e)}},removeState:function(e){var t=this.states[e];if(t===null){return}this.states[e]=null},transitionTo:function(e,t){if(e===null){return}this.canceled=false;if(this.getCurrentState()&&this.getCurrentState().exiting){this.sendNotification(this.getCurrentState().exiting,t,e.name)}if(this.canceled){this.canceled=false;return}if(e.entering){this.sendNotification(e.entering,t)}if(this.canceled){this.canceled=false;return}this.setCurrentState(e);if(e.changed){this.sendNotification(this.getCurrentState().changed,t)}this.sendNotification(utilities.statemachine.StateMachine.CHANGED,this.getCurrentState(),this.getCurrentState.name)},getCurrentState:function(){return this.viewComponent},setCurrentState:function(e){this.viewComponent=e}},{NAME:"StateMachine",ACTION:"/notes/action",CHANGED:"/notes/changed",CANCEL:"/notes/cancel"});puremvc.define({name:"utilities.statemachine.FSMInjector",parent:puremvc.Notifier,constructor:function(e){this.fsm=e}},{fsm:{},stateList:null,inject:function(){var e=new utilities.statemachine.StateMachine,t=this.states();for(var n=0;n<t.length;n++){e.registerState(t[n],this.isInitial(t[n].name))}this.facade.registerMediator(e)},states:function(){var e=this.fsm.state;if(this.stateList===null){this.stateList=[];for(var t=0;t<e.length;t++){this.stateList.push(this.createState(e[t]))}}return this.stateList},createState:function(e){var t=new utilities.statemachine.State(e["@name"],e["@entering"],e["@exiting"],e["@changed"]),n=e.transition;if(n){for(var r=0;r<n.length;r++){t.defineTrans(n[r]["@action"],n[r]["@target"])}}return t},isInitial:function(e){return e===this.fsm["@initial"]}})